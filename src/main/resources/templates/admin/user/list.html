<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/admin/basic">

	<th:block layout:fragment="content">
		<div class="contents">
			<div class="page_route">
				<a href="#" class="home" title="Home">Home</a>
				<a href="#" title="회원 관리">회원 관리</a>
				<a href="#" title="회원 목록">회원 목록</a>
			</div>

			<div class="inner">
				<h1 class="page_title">회원목록</h1>

				<div class="search_box text_center">
					<dl>
						<dt>ID</dt>
						<dd>
							<input type="text" value="" class="wd70" />
						</dd>
					</dl>
					<dl>
						<dt>닉네임</dt>
						<dd>
							<input type="text" value="" class="wd70" />
						</dd>
					</dl>
					<dl>
						<dt>연락처</dt>
						<dd>
							<input type="text" value="" class="wd150" />
							<input type="submit" value="검색" class="btn btn_search" />
						</dd>
					</dl>
				</div>
				<!--/* .search_box */-->

				<div class="board_list">
					<table>
						<caption></caption>
						<colgroup>
							<col style="width: 5%" />
							<col style="*" />
							<col style="width: 10%" />
							<col style="*" />
							<col style="*" />
							<col style="*" />
							<col style="*" />
							<col style="width: 90px" />
						</colgroup>
						<thead>
							<tr>
								<th>번호</th>
								<th>아이디</th>
								<th>닉네임</th>
								<th>연락처</th>
								<th>권한</th>
								<th>잠김</th>
								<th>탈퇴</th>
								<th>관리</th>
							</tr>
						</thead>
						<tbody>
							<tr th:if="${not #lists.isEmpty( users )}" th:each="row, status : ${users}">
								<td th:text="${row.idx}"></td>
								<td th:text="${row.username}"></td>
								<td th:text="${row.nickname}"></td>
								<td th:text="${row.phone}"></td>
								<td>
									<select name="authorities">
										<option th:each="authority,status : ${row.authorities}" th:value="${authority}" th:text="${row.authorityNames[status.index]}"></option>
									</select>
								</td>
								<td>
									<select name="accountNonLocked" th:onchange="changeAccountStatus([[ ${row.idx} ]], this.name, this.value)">
										<option value="true" th:checked="${row.accountNonLocked == true}">N</option>
										<option value="false" th:checked="${row.accountNonLocked == false}">Y</option>
									</select>
								</td>
								<td>
									<select name="enabled" th:onchange="changeAccountStatus([[ ${row.idx} ]], this.name, this.value">
										<option value="true" th:checked="${row.enabled == true}">N</option>
										<option value="false" th:checked="${row.enabled == false}">Y</option>
									</select>
								</td>
								<td>
									<input type="button" class="btn btn_gray" value="삭제" th:onclick="deleteUser([[ ${row.username} ]])" />
								</td>
							</tr>
						</tbody>
					</table>
				</div>
				<!--/* //.board_list */-->

				<div class="paging">
					<a href="#" class="btn_prev_db"></a>
					<a href="#" class="btn_prev"></a>
					<a href="#" class="active">1</a>
					<a href="#">2</a>
					<a href="#">3</a>
					<a href="#">4</a>
					<a href="#">5</a>
					<a href="#" class="btn_next"></a>
					<a href="#" class="btn_next_db"></a>
				</div>
			</div>
			<!--/* //.inner */-->
		</div>
		<!--/* //.contents */-->
	</th:block>

	<th:block layout:fragment="script">
		<script th:inline="javascript">
		/* <![CDATA[ */

// 			function changeAccountStatus(idx, name, value) {

// 			var test = name;
// 			console.log(name);
// 			console.log(value);
// 			return false;
// 				var data = {
// 					name : value
// 				};
// 				console.log(data);
// 				return false;
			
// 				/*[- spring security csrf token -]*/
// 				var token = $("meta[name='_csrf']").attr("content");
// 				var uri = [[ @{/users/} ]] + idx;

// 				$.ajax({
// 					url : uri,
// 					type : "patch",
// 					headers : {
// 						"X-HTTP-Method-Override" : "patch",
// 						"X-CSRF-TOKEN" : token,
// 					},
// 					dataType : "json",
// // 					data : data,
// 					async : false,
// 					success : function(response) {
// 						console.log(response)
// 					},
// 					error : function(request, status, error) {
// 						alert("오류가 발생하였습니다. 새로고침 후에 다시 시도해 주세요.");
// 					}
// 				});
// 			}

		/* ]]> */
		</script>
	</th:block>

</html>